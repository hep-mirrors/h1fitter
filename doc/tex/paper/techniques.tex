
With increased precision of data measurements, the calculations had to progress to higher accuracy as well, which usually translates into compuationally demanding calculations even for the DIS processes. Due to the complicated 
nature of these calculation involving an increased number of diagrams with each 
additional order, they are too slow to be used iteratively in a fit.
There are several methods available to speed-up such calculations to allow for impact studies and practical PDF extractions.  Two of such techniques
are implemented into \fitter\ : the $k-factor$ approximation from lower (LO) to higher order (NLO) and the so-called fast grid technique using an interface to packages such as FastNLO and APPLGRID, both of them shortly described below.  


\begin{description}
\item \bf {$k-factor$ technique:} \rm

The $k-factor$ technique has been adopted within the \fitter\ framework which is  
defined as a ratio of predictions at the first iteration between a highest order 
in the perturbative QCD calculation available for a given process to a fast calculation (which usually implies either lower order calculations, or neglicting terms in calculations that are slow). Then the difference is stored into so-called `` k-factors''  tables that are applied on the fly to each subsequent fit iteration which will use a fast prediction calculated for each data point and corrected by this `` k-factor''.

\begin{itemize}
\item For the DIS process, the heavy flavour schemes provide accurate but computationally slow calculations. In \fitter a so-called `` FAST'' schemes were implemented such athat
the ratio between same order calculations but massless vs massive 
(i.e. NLO (ZM-VFNS)/NLO (ACOT), or as the ratio between LO (massless)/NLO (massive),
can be invoked.


The $k-factors$ are only calculated for the PDF parameters at the first fit iteration
hence, the recommended is the full scheme.
%Hence the RT-fast calculation must be repeated by inputting the final PDF parameters 
%and iterating this procedure until the input and output PDFs are not significantly different
%%%%



\item In Drell-Yan case, as described in section~\ref{dysection}, a list of theoretical packages are available in providing accurate predictions for the LHC observables.


The leading order DY triple differential cross section in
invariant mass \(M\), boson rapidity \(y\) and CMS
lepton scattering angle \(\cos\theta\), for the neutral current, 
can be written as~\cite{Drell:1970wh,Yamada:1981mw}:
\begin{align}
% \scriptstyle
 \textstyle
% \frac{\mathrm{d}^3\sigma}{\mathrm{d}M\mathrm{d}y\mathrm{d}\cos\theta} &= 
 \frac{d^3\sigma}{dM{d}y d\cos\theta} =  
 \frac{\pi\alpha^2}{3MS}\sum_{q}P_q \left[F_q(x_1,Q^2)F_{\bar{q}}(x_2,Q^2) 
 + (q\leftrightarrow\bar{q})\right],
\end{align}
where \(S\) is the squared CMS beam energy, \(x_{1,2} = \frac{M}{\sqrt{S}}\exp(\pm y)\), $F_q(x_1,Q^2)$ 
is the parton number density, and 
\begin{align}
  P_q &=  e_l^2e_q^2(1+\cos^2\theta) \nonumber \\
      &+  e_le_q\frac{2M^2(M^2-M_Z^2)}{\sin^2\theta_W\cos^2\theta_W
          \big[(M^2-M_Z^2)^2+\Gamma_Z^2M_Z^2\big]} \nonumber \\
      &    \big[aA_q(1+\cos^2\theta)+2bB_q\cos\theta\big] \nonumber \\
      &+  \frac{M^4}{\sin^4\theta_W\cos^4\theta_W
          \big[(M^2-M_Z^2)^2+\Gamma_Z^2M_Z^2\big]} \nonumber \\
      &    \big[(a^2+b^2)(A_q^2+B_q^2)(1+\cos^2\theta)+8abA_qB_q\cos\theta\big].
\end{align}
Here \(\theta_W\) is the Weinberg angle, \(M_Z\) and \(\Gamma_Z\) are Z boson mass and 
width, $a, b, A_q, B_q, e_l, e_q$ are electro-weak couplings.
%\begin{align}
% a & = -\frac{1}{4} + \sin^2\theta_W, \  b  = -\frac{1}{4}, \nonumber \\
% A_q & = \frac{1}{2}I_q^3-e_q\sin^2\theta_W, \ B_q  = \frac{1}{2}I_q^3, \ I_u^3  = -I_d^3 = \frac{1}{2},  \nonumber \\
% e_l & = -1, e_u = \frac{2}{3}, e_d = -\frac{1}{3}.
%\end{align}
\\
\\
The expression for charged current scattering has a simpler form.
\begin{align}
\frac{d^3\sigma}{dMdyd\cos\theta} &=
 \frac{\pi\alpha^2}{48S\sin^4\theta_W}
 \frac{M^3(1-\cos\theta)^2}{(M^2-M_W^2)+\Gamma_W^2M_W^2}  \nonumber \\
 & \sum_{q_1,q_2}V_{q_1q_2}^2F_{q_1}(x_1,Q^2)F_{q_2}(x_2,Q^2),
\end{align}
where \(V_{q_1q_2}\) is the CKM quark mixing matrix and \(M_W\) and \(\Gamma_W\)
are \(W\) boson mass and decay width.

The simple form of these expressions allows the calculation of integrated
cross sections without utilization of Monte-Carlo techniques which often 
introduce statistical fluctuations.
%This is particularly useful for PDF fitting purposes because
%statistical fluctuations are avoided in this case. 
In both neutral and charged current expressions the parton distribution functions
factorise as functions dependent only on boson rapidity \(y\) and
invariant mass \(M\).
%leaving \(\cos\theta\) dependence aside.
The integral in \(\cos\theta\) can be computed analytically and
integrations in \(y\) and \(M\) can be performed with the Simpson
method. The \(\cos\theta\) parts are kept in the equation 
explicitly because their integration is asymmetric for
data in lepton \(\eta\) bins and also because of the need to apply 
lepton \(p_{\perp}\) cuts.

The fact that PDF functions factorise, allows high speed calculations when 
performing parameter fits over lepton rapidity data. In this case
the factorised part of the expression which is independent of PDFs can be
calculated only once for all minimisation iterations.
The leading order code in \fitter\ package implements this 
optimisation and uses fast convolution routines provided by
QCDNUM. Currently the full width LO calculations are optimised 
for lepton pseudorapidity and boson rapidity distributions with the
possibility to apply lepton \(p_{\perp}\) cuts.
%making this procedure flexible to describe data.
This flexibility allows the calculations to be performed within the phase space
corresponding to the available measurement.

%The calculated leading order cross sections are multiplied by
%NLO or NNLO k-factors provided for corresponding data distributions.
The calculated leading order cross sections are multiplied by
$k-factors$ to obtain predictions at NLO.
\end{itemize}

%or NNLO precision.
%%%%
%\subsubsection{APPLGRID}
%\vspace{0.1cm}


\item \bf {Fast Grid Technique:} \rm


\begin{itemize}
\item The APPLGRID~\cite{Carli:2010rw} package allows the fast computation 
of NLO cross sections for particular processes for arbitrary sets of 
proton parton distribution functions. The package implements
calculations of DY production as well as jet production in $pp(\bar p)$
collisions and DIS processes. 

The approach is based on storing the perturbative coefficients
of NLO QCD calculations of final-state observables measured
in hadron colliders in look-up tables. The PDFs and the 
strong couplings are included during the final calculations,
e.g. during PDF fitting. The method allows 
variation of factorization and renormalization scales in
calculations.

The look-up tables (grids) can be generated with modified versions
of MCFM parton level generator~\cite{Campbell:1999ah,Campbell:2010ff} 
or NLOjet++~\cite{Nagy:2001fj} code for the jet production.
The model input parameters are in fact pre-set following the 
MCFM input steering card, while binning and definitions of the
cross section observables are set in the APPLGRID code.
%as distributed with the full version of APPLGRID package.
% NLO calculations
%for the current analysis are performed with the help of APPLGRID
%generated grids based on MCFM calculations. 
%
%APPLGRID supports an interface to the MCFM parton level generators,
%hence model input parameters such as electroweak parameters
%are in fact pre-set following the MCFM input steering card, while
%binning and definitions of the observables for which the
%differential cross sections are needed are set in the 
%APPLGRID code. 
%The grid parameters \(x_1, x_2\) and \(Q^2\) binning
The grid parameters, \(Q^2\) binning
and interpolation orders are also defined in the code.

APPLGRID constructs the grid tables in two 
steps: {\it (i)} exploration of the phase space in order
to optimize the memory storage and {\it (ii)} actual grid
construction in the phase space corresponding to the 
requested observables.
Afterwards the NLO cross sections are restored from the grids
using externally provided PDFs, \(\alpha_S\), factorization and 
renormalization scales. QCD NNLO $k-factors$ can be applied
if requested.

\item
The FastNLO project~\cite{Kluge:2006xs,Wobisch:2011ij,Britzger:2012bs}
%enables the inclusion of jet data in PDF and $\alpha_s$ fits.
uses multi-dimensional interpolation
techniques to convert the convolutions of perturbative 
coefficients with parton distribution functions and 
the strong coupling into simple products.
%Although the concept is process independent, 
The perturbative 
coefficients are calculated by the \texttt{NLOJET++}
program~\cite{Nagy:1998bb} where calculations for jet-production
in DIS~\cite{Nagy:2001xb}  as well as in hadron-hadron 
collisions~\cite{Nagy:2003tz,Nagy:2001fj} with threshold-corrections 
of $\mathcal{O}$(NNLO) for inclusive jet cross 
sections~\cite{Kidonakis:2000gi} are available.

The fastNLO libraries are included in the \fitter\ package
%and no further requirements or compilation options
%are needed.
and in order to include a new measurement into the PDF fit,
only the fastNLO tables have to be specified. These tables include all
necessary information about the perturbative coefficients and the
calculated process for all bins of a certain dataset. 
%Tables for almost all published jet measurements
%are available through the project website \\ {\tt http://fastnlo.hepforge.org}.
%
%Features of the fastNLO concept are the very quick convolution of the
%perturbative coefficients with the PDFs, of
%$\mathcal{O}(100 ms)$, and the very high accuracy
%of the interpolation procedure. 
The fastNLO tables are conventionally calculated
for multiple factors of the factorization scale, 
and the renormalization scale factor can be chosen freely.
Some of the fastNLO tables already allow for 
%already involve a scale-independent
%concept~\cite{Britzger:2012bs}, which allows for 
the free choice~\cite{Britzger:2012bs} of the renormalization and the factorization
scale as a function of two pre-defined observables.
The evaluation of the strong coupling constant, which enters
the cross section calculation, is taken consistently from the 
QCDNUM evolution code.
\end{itemize}

\end{description}

