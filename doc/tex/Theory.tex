\label{sec:theory}
The \fitter\ program uses currently as standard the DGLAP~\cite{Gribov:1972ri,Gribov:1972rt,Lipatov:1974qm,Dokshitzer:1977sg,Altarelli:1977zs}
 evolution equations as implemented in the QCDNUM~\cite{qcdnum} program. The fit 
procedure begins with parameterising the input PDFs at the starting 
scale $Q^2_0$ which should be chosen to be below the charm mass threshold
$m_C^2$.
The PDFs are then evolved using the DGLAP evolution equations  
at NLO~\cite{Curci:1980uw,Furmanski:1980cm} in the $\overline{MS}$ scheme.
The renormalisation and factorisation scales are set to $Q^2$. The \fitter\ program
also allows for LO and NNLO evolution. 

The cross-section predictions are obtain by convoluting the PDFs with the 
hard scattering coefficient functions. For the DIS processes, those are calculated 
using the general mass variable-flavour scheme. 
The program implements the  zero mass scheme from QCDNUM as well as
various treatments for the heavy quark thresholds as provided by the MSTW group
- the RT scheme with its variants at NLO and NNLO ~\cite{Thorne:1997ga,Thorne:2006qt}, as provided by the CTEQ group - the ACOT scheme with its variants at LO and NLO, as provided by the ABM group - the BMSN scheme at NLO and NNLO.
Each of these schemes is briefly discussed in further details.

The jet cross sections
are calculated using APPLGRID and FastNLO. The program has two implementations
for $pp$  DY processes. The first implementation uses
calculations at LO which can be extended to NLO using k-factors,
the second uses the APPLGRID interface.
For thorough details of the theoretical modules we direct the user to read the provided  references of these packages.


%%%%%%%%%%%
\subsection{DIS and Schemes}
There are different approaches to the treatment of the heavy quark production. These include the Fixed Flavour Number (FFN) and Variable Flavour Number (VFN) schemes.
%%%%
\subsubsection{ZMVFNS}
The evolution program QCDNUM~\cite{qcdnum} used in \fitter\ provides 
the calculation of the deep inelastic structure functions in the zero-mass, 
generalised mass and the fixed flavour number schemes. 
In the zero-mass variable flavour number scheme (ZM-VFNS) heavy quark densities are
included into proton above quark masses but they are treated as massless in both,
the initial and final states.
This scheme is accurate in the region where $Q^2$ is so much greater than $m_h^2$
but becomes unreliable for $Q^2 \sim m_h^2$. \\
The un-polarised DIS structure functions in ZM-VFN scheme are computed as a 
convolution of the parton densities with zero-mass coefficient functions and 
in \fitter\ are activated via namelist {\tt HF$\_$SCHEME} in the {\tt steering.txt}.
%%%%
\subsubsection{TR}

The Thorne-Roberts (TR) scheme is a general-mass variable flavour number scheme (GM-VFNS) used as default for the MTSW PDF sets. GM-VFNS smoothly connect the two reagions: scale below the heavy quark threshold and the scale above the heavy quark threshold. However, the definition is not unique.
A GM-VFNS can be defined by demanding equivalence of the nf = n (FFNS) and nf = n+1 flavour (ZM-VFNS) descriptions above the transition point for the new parton distributions
(they are by definition identical below this point), at all orders. However, the equivalency of swapping te O(mH2/Q2) terms without violating the definition of a GM-VFNS is what mainly distinguish the ACOT from TR schemes. 
One major issue in a complete GM-VFNS, is that of the ordering of the
perturbative expansion. This ambiguity comes about because the ordering in alphas is different for the number of active flavours.


 
%%%%
\subsubsection{ACOT}

The Aivazis-Collins-Olness-Tung scheme  belongs to the group of VFN factorization schemes that uses the renormalization method of Collins-Wilczek-Zee (CWZ).This scheme involves a mixture of the $\bar{MS}$ scheme for light partons (and for heavy partons if the factorisation scale is larger than the heavy mass)and the zero-momentum subtraction renormalization scheme for graphs with heavy quark lines (if factorisation scale is smaller than the mass of the heavy quark threshold).

There are different variants of this scheme which are all incorporated in the HERAFitter framework.

%%%%
\subsubsection{ABM}
An interface to open-source code OPENQCDRAD~\cite{openqcdrad:page} in HERAFitter framework 
provides an access to 
fixed flavour number scheme (FFNS)~\cite{Laenen:1992,Laenen:1993,Riem:1995}~\footnote{Besides 
the variable flavour number 
scheme, QCDNUM also supports the fixed flavour number scheme which can be used for variouse 
cross checks with OPENQCDRAD.}. In FFNS the number of light quark 
flavours $n_{f}$ (here $n_{f}=3$) are considered in the PDF evolution and heavy (massive) 
quarks appear only in the final state. 
The QCD corrections to the massive Wilson coefficients which are known up to the NNLO
for the neutral-current (NC) heavy-quark production~\cite{} are implemented in OPENQCDRAD.
In the case of charged-current (CC), the massive NLO QCD corrections~\cite{} are available.
In addition, the treatment of the heavy-quark contributions in DIS are provided 
in both, the pole-mass and the running-mass definition in $\overline{\text{MS}}$ 
scheme~\cite{Alekhin:runm}. \\
In case the FFN scheme is chosen as the fitting option (see corresponding instructions in the section 1),
the heavy quark contributions to DIS structure functions $F_2$ and $F_L$ (and $F_3$ in the charged 
current case) are calculated in the FFNS and together with the light-flavor contributions are 
provided for the theory prediction calculation (theory$\_$dispatcher.f).
The interpolation to PDFs and $\alpha_s$ evolution from QCDNUM are set up in the interface to OPENQCDRAD. \\
The variation of the renormalisation and factorisation scales for heavy quarks is 
possible (see available options in steering.txt file).
%
%       
%%%%%%%%%%%
\subsubsection{$ep$ Electroweak corrections via HS}
%%%%%%%%%%%
\subsection{DY process}
%%%%
\subsubsection{Leading Order}
The leading order Drell-Yan~\cite{Drell:1970wh,Yamada:1981mw} cross section 
for the neutral current, triple differential in
invariant mass \(M\), boson rapidity \(y\) and CMS
lepton scattering angle \(\cos\theta\), can be written as
\begin{align}
\frac{\mathrm{d}^3\sigma}{\mathrm{d}M\mathrm{d}y\mathrm{d}\cos\theta} &=
  \frac{\pi\alpha^2}{3MS}\sum_{q}P_q
  \left[F_q(x_1,Q^2)F_{\bar{q}}(x_2,Q^2) + (q\leftrightarrow\bar{q})\right],
\end{align}
where \(S\) is a squared CMS beam energy, \(x_{1,2} = \frac{M}{\sqrt{S}}\exp(\pm y)\) and 
\begin{align}
  P_q &=  e_l^2e_q^2(1+\cos^2\theta) \nonumber \\
      &+  e_le_q\frac{2M^2(M^2-M_Z^2)}{\sin^2\theta_W\cos^2\theta_W
          \big[(M^2-M_Z^2)^2+\Gamma_Z^2M_Z^2\big]}
          \big[aA_q(1+\cos^2\theta)+2bB_q\cos\theta\big] \nonumber \\
      &+  \frac{M^4}{\sin^4\theta_W\cos^4\theta_W
          \big[(M^2-M_Z^2)^2+\Gamma_Z^2M_Z^2\big]}
          \big[(a^2+b^2)(A_q^2+B_q^2)(1+\cos^2\theta)+8abA_qB_q\cos\theta\big].
\end{align}
Here \(\theta_W\) is the Weinberg angle, \(M_Z\) and \(\Gamma_Z\) are Z boson mass and 
width, and
\begin{align}
 a & = -\frac{1}{4} + \sin^2\theta_W,  \nonumber \\
 b & = -\frac{1}{4},  \nonumber \\
 A_q & = \frac{1}{2}I_q^3-e_q\sin^2\theta_W, \nonumber \\
 B_q & = \frac{1}{2}I_q^3,  \nonumber \\
 I_u^3 & = -I_d^3 = \frac{1}{2},  \nonumber \\
 e_l & = -1, e_u = \frac{2}{3}, e_d = -\frac{1}{3}.
\end{align}

The expression for charged current has simpler form:
\begin{align}
\frac{\mathrm{d}^3\sigma}{\mathrm{d}M\mathrm{d}y\mathrm{d}\cos\theta} &=
 \frac{\pi\alpha^2}{48S\sin^4\theta_W}
 \frac{M^3(1-\cos\theta)^2}{(M^2-M_W^2)+\Gamma_W^2M_W^2}
 \sum_{q_1,q_2}V_{q_1q_2}^2F_{q_1}(x_1,Q^2)F_{q_2}(x_2,Q^2),
\end{align}
where \(V_{q_1q_2}\) is the CKM quark mixing matrix and \(M_W\) and \(\Gamma_W\)
are \(W\) boson mass and decay width.

The simple form of these expressions allows to calculate integrated
cross sections without utilization of Monte-Carlo techniques.
This is particularly useful for PDF fitting purposes because
the statistical fluctuations are avoided in this case. In both 
neutral and charge current expressions the parton density functions
factorize as a function dependent only on boson rapidity \(y\) and
invariant mass \(M\) leaving \(\cos\theta\) dependence aside.
The integral in \(\cos\theta\) can be computed analytically and
integrations in \(y\) and \(M\) can be performed with Simpson
method. The \(\cos\theta\) parts are kept in the equation 
explicitly because their integration is asymmetric for
data in lepton \(\eta\) bins and also is being performed when applying 
the lepton \(p_{\perp}\) cuts.

The fact that PDF functions factorize with the rest part of 
expression allows to significantly boost calculations when 
performing parameter fits over lepton rapidity data. In this case
the factorized part of expression independent on PDFs can be
calculated only once for all minimization iterations.
The leading order code in HERAFitter package implements this 
optimization and uses fast convolution routines provided by
QCDNUM. Currently the full width LO calculations are optimized 
for lepton pseudorapidity and boson rapidity distributions with
possibility to apply lepton \(p_{\perp}\) cuts.

The calculated leading order cross sections are multiplied by
NLO or NNLO K-factors provided for corresponding data distributions.
%%%%
\subsubsection{Next Leading Order}
%%%%%%%%%%%
\subsection{$t\bar{t}$ Cross Sections via {\tt HATHOR}}
Top-quark pairs ($t\bar{t}$) are mainly produced via $gg$ fusion and
$q \bar q$ annihilation. Furthermore, there are the $q q'$ and
$q g$ production modes.
The program HATHOR~\cite{Aliev:2010zk} allows calculating
the expected total $t \bar t$ cross section at hadron colliders
($p \bar p$ and $p p$) up to approximate NNLO accuracy.
Version 1.3 of HATHOR includes the exact NNLO for $q \bar q \to t \bar t$ \cite{Baernreuther:2012ws}
as well as a new high-energy constraint on the approximate NNLO obtained from
soft-gluon resummation \cite{Moch:2012mk}.
The default choice for renormalization and factorization scale in $t \bar t$ production is the top-quark mass, $m_t$.
The pole mass scheme is typically employed for $m_t$ but HATHOR also supports calculations in
the $\overline{\text{MS}}$ scheme.
\subsection{Jets}
The calculation of higher order jet cross sections is very demanding
in means of computing power. The reasons are the large number of contributing
Feynman diagrams and also the large number of infrared divergencies.
For an accurate cancellation of these singularities, typically, the 
dipole subtraction method is applied in such calculations.
During the necessary Monte Carlo integration a very fine phase
space sampling has to be performed in order to account for the
accurate cancellation of the counter terms.

In order to enable the inclusion of jet-cross section 
measurements in PDF and $\alpha_s$ fits, these perturbative
coefficients have to be pre-computed in a PDF and $\alpha_s$ 
independent way. For this purpose, two quite similar tools are
interfaced to the HERAFitter.

\subsubsection{FastNLO}
The fastNLO project~\cite{Kluge:2006xs,Wobisch:2011ij,Britzger:2012bs}
enables the inclusion of jet data in PDF and $\alpha_s$ fits.
This tool uses multi-dimensional interpolation
techniques to convert the convolutions of perturbative 
coeffcients with parton distribution functions and 
the strong coupling into simple products.
Although the concept is process independent, the perturbative 
coefficients are usually calculated by the \texttt{NLOJET++}
program~\cite{Nagy:1998bb} where calculations for jet-production
in DIS~\cite{Nagy:2001xb}  as well as in hadron-hadron 
collisions~\cite{Nagy:2003tz,Nagy:2001fj} are available.
Also threshold-corrections of $\mathcal{O}$(NNLO) for 
inclusive jet cross sections in hadron-hadron collisions are
available~\cite{Kidonakis:2000gi}.

The fastNLO libraries are standardized included in the HERAFitter
package and no further requirements or compilation options
are needed. In order to include a new measurement into the PDF-fit,
the fastNLO table have to be specified. These tables include all
necessary informations of the perturbative coefficients and the
calculated process for all bins of a certain dataset. 
Tables for almost all published jet measurements
are available through the project website {\tt http://fastnlo.hepforge.org},
or have otherwise to be calculated by using the full fastNLO package.

Features of the fastNLO concept are the very quick convolution of the
perturbative coefficients with the PDFs of
$\mathcal{O}(100 ms)$ and the very high accuracy
of the interpolation procedure. 
The fastNLO tables are conventionally calculated
for multiple factors of the factorization scale, 
and the renormalization scale factor can be choosen freely.
Some of the fastNLO tables already involve a scale-independent
concept~\cite{Britzger:2012bs}, which allows for 
the free choice of the renormalization and the factorization
scale as a function of two pre-defined observables.
The evaluation of the strong coupling constant, which enters
the cross section calculation, is taken consistently from the 
QCDNUM evolution code.


\subsubsection{APPLGRID}
The APPLGRID~\cite{Carli:2010rw} package allows to compute a fast estimate
of NLO cross section for particular processes for arbitrary set of 
proton parton density functions. The package implements
calculation of cross section of electroweak boson (\(Z,W\))
production as well as jet production in proton-(anti)proton
collisions and DIS processes. 

The approach is based on storing perturbative coefficients
of NLO QCD calculations of final-state observables measured
in hadron colliders in look-up tables. The PDFs and the 
strong couplings are included during the final calculations,
e.g. during the PDF fits procedure. The method allows 
variation of factorization and renormalization scales in
calculations.

The look-up tables (grids) can be generated with modified versions of
of MCFM~\cite{Campbell:1999ah,Campbell:2010ff} or 
NLOjet++~\cite{Nagy:2001fj} software distributed
with the full version of APPLGRID package. NLO calculations
for the current analysis are performed with the help of APPLGRID
generated grids based on MCFM calculations. 

Run parameters
and electroweak parameters are set in MCFM in a standard way
via the input file and user's part of the code. 
Binning and definitions of the observables for which the
differential cross sections are needed are set in the 
APPLGRID code. 
The grid parameters \(x_1, x_2\) and \(Q^2\) binning
and interpolation orders are also defined in the code.

APPLGRID performs construction of the look-up tables in two 
steps: {\it (i)} exploration of the phase space in order
to optimize the memory storage and {\it (ii)} actual grid
construction in the phase space corresponding to the 
requested observables.

Afterwards the NLO cross sections are restored from the grids
with providing PDFs, \(\alpha_S\), factorization and 
renormalization scales and with QCD NNLO k-factors applied
if stated.

%%%%%%%%%%%
\subsection{DIPOLE models}

At low $x$ and low $Q^{2}$, virtual photon-proton scattering is described using the colour
dipole model formalism~\cite{NNZ:91}. Within this formalism, the scattering process is calculated as a fluctuation of the
photon into a quark-antiquark pair (dipole), with a lifetime $\propto\enskip 1/x$, which interacts with the proton.

Several approaches have been developed to phenomenologically describe the dipole-proton interaction
cross section, three of which are implemented in the HERAFitter. These are
the original model version (GBW)~\cite{Golec-Biernat:1998js}, a model based on the colour glass condensate approach
to the high parton density regime (IIM)~\cite{Iancu:2003ge}, and a modified GBW model by adding effects of the 
DGLAP evolution (BGK)~\cite{Bartels:2002cj}.
%%%%
\subsubsection{GBW model}
In the GBW model the dipole-proton cross section $\sigma_{\text{dip}}$ is given by
\begin{equation}
\label{eGBW}
   \sigma_{\text{dip}}(x,r^{2}) = \sigma_{0} \left(1 - \exp \left[-\frac{r^{2}}{4R_{0}^{2}(x)} \right]\right),
\end{equation}
where $r$ corresponds to the transverse separation between the quark and the antiquark, and $R_{0}^{2}$ is 
an $x$ dependent scale parameter, having the form $R_{0}^{2}(x)=\left(x/x_{0}\right)^{\lambda}$.
The free fitted parameters are the cross-section normalisation $\sigma_{0}$ as well as $x_{0}$ and $\lambda$.
%%%%
\subsubsection{IIM model}
The IIM model assumes an improved expression for dipole cross section which is based on the 
Balitsky-Kovchegov equation~\cite{Balitsky:1995ub}. The explicit formula for $\sigma_{\text{dip}}$ 
can be find in~\cite{Iancu:2003ge}. The free fitted parameters are the alternative scale parameter $\tilde{R}$, $x_{0}$ and $\lambda$.
%%%%
\subsubsection{BGK model}
The BGK model modifies the equation (\ref{eGBW}) by incorporating the LO and NLO DGLAP evolution
of the gluon distribution. This leads to the expression for the dipole cross section
\begin{equation*}
\label{eBGK}
   \sigma_{\text{dip}}(x,r^{2}) = \sigma_{0} \left(1 - \exp \left[-\frac{\pi^{2} r^{2} \alpha_{s}(\mu^{2}) xg(x,\mu^{2})}{3 \sigma_{0}} \right]\right).
\end{equation*}
The factorization scale $\mu^{2}$ has the form $\mu^{2} = C_{bgk}/r^{2}+\mu^{2}_{0}$.
This model uses the following gluon density at the starting scale $Q_{0}^{2}=1\mbox{ GeV}^{2}$
\begin{equation*}
\label{eqTH730}
   xg(x,Q^{2}_{0}) = A_{g} x^{-\lambda_{g}}(1-x)^{C_{g}}.
\end{equation*}
The free fitted parameters for this model are $\sigma_{0}$, $\mu^{2}_{0}$ and 3 parameters for gluon $A_{g}$, $\lambda_{g}$, $C_{g}$. The parameter $C_{bgk}$ is kept fixed: $C_{bgk} = 4.0$. 
%%%%
\subsubsection{Mixed with DGLAP model}
%%%%%%%%%%%
\subsection{Unintegrated PDFs using CASCADE}
%%%%%%%%%%%
\subsection{Diffractive DIS PDFs}
Diffractive DIS data are fitted within the 'proton vertex factorisation' approach where 
the diffractive DIS is mediated by the exchange of hard Pomeron and a secondary Reggeon.
The model supplied by the DiffDIS package provides values of the 'reduced cross section',
$\sigma_r = F_2 - y^2/(1+(1-y)^2) F_L$
which is expected to be the experimentally meausured quantity.
The model supplied by the DiffDIS package provides values of the 'reduced cross section',
$\sigma_r = F_2 - y^2/(1+(1-y)^2) F_L$
which is expected to be the experimentally meausured quantity.
\\
\input{./dpdfs.tex}        

